<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Sans Serif:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Java,安卓," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="引言在安卓安全模型中，一个应用程序不能够直接去访问（读或写）另一个应用程序的数据，每个应用程序都有其自己的带id的结构化数据，自己的文件夹和私有的内存区域，ContentProvider是在这些应用程序间件共享数据。ContentProvider是一组包裹在标准的API下的读写操作。应用程序都必须注册为数据提供者才能共享数据，其它的应用程序能够通过固定的API去读写这些数据，所以ContentPr">
<meta property="og:type" content="article">
<meta property="og:title" content="写一个ContentProvider的实用案例">
<meta property="og:url" content="http://yoursite.com/2016/09/12/写一个ContentProvider的实用案例/index.html">
<meta property="og:site_name" content="Gordon's Blog">
<meta property="og:description" content="引言在安卓安全模型中，一个应用程序不能够直接去访问（读或写）另一个应用程序的数据，每个应用程序都有其自己的带id的结构化数据，自己的文件夹和私有的内存区域，ContentProvider是在这些应用程序间件共享数据。ContentProvider是一组包裹在标准的API下的读写操作。应用程序都必须注册为数据提供者才能共享数据，其它的应用程序能够通过固定的API去读写这些数据，所以ContentPr">
<meta property="og:image" content="http://yoursite.com/one.jpg">
<meta property="og:updated_time" content="2016-09-14T04:04:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="写一个ContentProvider的实用案例">
<meta name="twitter:description" content="引言在安卓安全模型中，一个应用程序不能够直接去访问（读或写）另一个应用程序的数据，每个应用程序都有其自己的带id的结构化数据，自己的文件夹和私有的内存区域，ContentProvider是在这些应用程序间件共享数据。ContentProvider是一组包裹在标准的API下的读写操作。应用程序都必须注册为数据提供者才能共享数据，其它的应用程序能够通过固定的API去读写这些数据，所以ContentPr">
<meta name="twitter:image" content="http://yoursite.com/one.jpg">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>

  <title> 写一个ContentProvider的实用案例 | Gordon's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Gordon's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">still believe in that world can be reshaped by coding and we can benifit from it.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Blogs
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Timeline
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                写一个ContentProvider的实用案例
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-09-12T10:31:58+08:00" content="2016-09-12">
              2016-09-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h4><p>在安卓安全模型中，一个应用程序不能够直接去访问（读或写）另一个应用程序的数据，每个应用程序都有其自己的带id的结构化数据，自己的文件夹和私有的内存区域，ContentProvider是在这些应用程序间件共享数据。ContentProvider是一组包裹在标准的API下的读写操作。应用程序都必须注册为数据提供者才能共享数据，其它的应用程序能够通过固定的API去读写这些数据，所以ContentProvider严格遵守CRUD原则。<br>常见的实用ContnentProvider的案例有读取联系人方式、读取多媒体信息、以及其它的应用程序数据，同时也允许这些应用程序增删改查这些数据。<br><a id="more"></a></p>
<center><img src="one.jpg" alt=""></center>

<p>上图示意了ContentProvider是如何工作的，App1储存它的数据到其自己的数据库并且提供提供一个provider，另一个应用程序App2通过这个共享出来的provider曲获取App1的数据。ContentProvider是一种简单抽象的接口，使用了标准的insert(),query(),update(),delete()方法来获取和更新数据，可见实现一个ContentProvider是非常简单的。</p>
<p>每个ContentProvider都会被冠以content://字符串开头的作为特殊标识的URI，这是用来区分不同的应用程序的。</p>
<h4 id="如何定义一个ContentProvider"><a href="#如何定义一个ContentProvider" class="headerlink" title="如何定义一个ContentProvider"></a>如何定义一个ContentProvider</h4><p>作为安卓最重要的组建之一，要定义一个ContentProvider我们主要有如下步骤：</p>
<ol>
<li>建立一个继承自ContentProvider的类</li>
<li>定义一个特殊的URI</li>
<li>实现所有的insert(), update(), query(), delete(), getType().方法</li>
<li>在AndroidManifest.xml中去声明</li>
</ol>
<h5 id="定义URI"><a href="#定义URI" class="headerlink" title="定义URI:"></a>定义URI:</h5><p>一个ContentProvider的URI定义的时候主要包括四部分.<br>比如：content://authority/path/id<br>content:// 所有的ContentProvider的URI定义都要以它打头<br>‘authority’ ContentProvider实现的时候的包名路径<br>‘path’ 这是一个虚拟的路由用来标识App下的某些数据的映射<br>‘id’ 可选字段，用来标识数据中的某一条信息</p>
<h5 id="增加新的纪录"><a href="#增加新的纪录" class="headerlink" title="增加新的纪录:"></a>增加新的纪录:</h5><p>We need to override insert() method of the ContentProvider to insert new record to the database via content provider. The caller method will have to specify the content provider URI and the values to be inserted without the ID. Successful insert operation will return the URI value with the newly inserted ID.<br>For example: If we insert a new record to the content provider content://com.example/sample<br>the insert method will return content://com.example/sample/1</p>
<h5 id="Updating-records"><a href="#Updating-records" class="headerlink" title="Updating records:"></a>Updating records:</h5><p>To update one or more records via content provider we need to specify the content provider URI. update() method of the ContentProvider is used to update records. We have to specify the ID of the record to update a single record. To update multiple records, we have to specify ‘selection’ parameter to indicate which rows are to be changed.<br>This method will return the number of rows updated.</p>
<h5 id="Deleting-records"><a href="#Deleting-records" class="headerlink" title="Deleting records:"></a>Deleting records:</h5><p>Deleting one or more records is similar to update process. We need to specify either ID or ‘selection’ to delete records. delete() method of the ContentProvider will return the number of records deleted.</p>
<h5 id="Querying-the-content-provider"><a href="#Querying-the-content-provider" class="headerlink" title="Querying the content provider:"></a>Querying the content provider:</h5><p>To query the data via content provider we orverride query() method of ContentProvider. This method has many parameters.  We can specify list columns to put into the result cursor using ‘projection’ parameter. We can specify ‘selection’ criteria. We can specify ‘sortOrder’ too.<br>If we do not specify projection, all the columns will be included in the result cursor. If we do not specify sortOrder the provider will choose its own sort order.</p>
<h5 id="getType-method"><a href="#getType-method" class="headerlink" title="getType() method:"></a>getType() method:</h5><p>This method is used handle requests for the MIME type of the data at the given URI. We use either vnd.android.cursor.item or vnd.android.cursor.dir/<br>vnd.android.cursor.item is used to represent specific item. Another one is used to specify all items.</p>
<h5 id="Registering-the-provider-in-AndroidManifest-xml"><a href="#Registering-the-provider-in-AndroidManifest-xml" class="headerlink" title="Registering the provider in AndroidManifest.xml"></a>Registering the provider in AndroidManifest.xml</h5><p>As with any other major parts of Android application, we have to register the content providers too in the AndroidManifest.xml. <provider> element is used to register the content providers. <application> is its parent element.</application></provider></p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Java/" rel="tag">#Java</a>
          
            <a href="/tags/安卓/" rel="tag">#安卓</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/09/11/Fragment的使用与常见的坑/" rel="next" title="Fragment的使用与常见的坑">
                <i class="fa fa-chevron-left"></i> Fragment的使用与常见的坑
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/09/14/Java8的Stream是时候用起来了/" rel="prev" title="Java8的Stream是时候用起来了">
                Java8的Stream是时候用起来了 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Gordon Rawe" />
          <p class="site-author-name" itemprop="name">Gordon Rawe</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">37</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#引言"><span class="nav-number">1.</span> <span class="nav-text">引言</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#如何定义一个ContentProvider"><span class="nav-number">2.</span> <span class="nav-text">如何定义一个ContentProvider</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#定义URI"><span class="nav-number">2.1.</span> <span class="nav-text">定义URI:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#增加新的纪录"><span class="nav-number">2.2.</span> <span class="nav-text">增加新的纪录:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Updating-records"><span class="nav-number">2.3.</span> <span class="nav-text">Updating records:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Deleting-records"><span class="nav-number">2.4.</span> <span class="nav-text">Deleting records:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Querying-the-content-provider"><span class="nav-number">2.5.</span> <span class="nav-text">Querying the content provider:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#getType-method"><span class="nav-number">2.6.</span> <span class="nav-text">getType() method:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Registering-the-provider-in-AndroidManifest-xml"><span class="nav-number">2.7.</span> <span class="nav-text">Registering the provider in AndroidManifest.xml</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  &copy; Copyright All rights are reserved by 
  <a href="https://github.com/gordon-rawe"><span class="author" itemprop="copyrightHolder">Gordon Rawe</span></a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  



  
  
  

  

  

</body>
</html>
